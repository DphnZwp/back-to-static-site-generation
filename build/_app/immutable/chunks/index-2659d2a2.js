const i={heading1:"heading1",heading2:"heading2",heading3:"heading3",heading4:"heading4",heading5:"heading5",heading6:"heading6",paragraph:"paragraph",preformatted:"preformatted",strong:"strong",em:"em",listItem:"list-item",oListItem:"o-list-item",list:"group-list-item",oList:"group-o-list-item",image:"image",embed:"embed",hyperlink:"hyperlink",label:"label",span:"span"},c={Any:"Any",Document:"Document",Media:"Media",Web:"Web"},y=()=>(++y.i).toString();y.i=0;const S=t=>{const r=_(t),e=[];for(let a=0;a<r.length;a++)e.push(v(r[a]));return{key:y(),children:e}},d=(t,r=[])=>({key:y(),type:t.type,text:"text"in t?t.text:void 0,node:t,children:r}),$=t=>d({type:i.span,text:t,spans:[]}),_=t=>{const r=t.slice(0);for(let e=0;e<r.length;e++){const a=r[e];if(a.type===i.listItem||a.type===i.oListItem){const s=[a];for(;r[e+1]&&r[e+1].type===a.type;)s.push(r[e+1]),r.splice(e,1);a.type===i.listItem?r[e]={type:i.list,items:s}:r[e]={type:i.oList,items:s}}}return r},v=t=>{if("text"in t)return d(t,L(t.spans,t));if("items"in t){const r=[];for(let e=0;e<t.items.length;e++)r.push(v(t.items[e]));return d(t,r)}return d(t)},L=(t,r,e)=>{if(!t.length)return[$(r.text)];const a=t.slice(0);a.sort((n,l)=>n.start-l.start||l.end-n.end);const s=[];for(let n=0;n<a.length;n++){const l=a[n],p=e&&e.start||0,g=l.start-p,b=l.end-p,T=r.text.slice(g,b),x=[];for(let h=n;h<a.length;h++){const m=a[h];m!==l&&m.start>=l.start&&m.end<=l.end&&(x.push(m),a.splice(h,1),h--)}n===0&&g>0&&s.push($(r.text.slice(0,g)));const I={...l,text:T};s.push(d(I,L(x,{...r,text:T},l))),b<r.text.length&&s.push($(r.text.slice(b,a[n+1]?a[n+1].start-p:void 0)))}return s},j=(t,r)=>N(S(t).children,r),N=(t,r)=>{const e=[];for(let a=0;a<t.length;a++){const s=t[a],n=r(s.type,s.node,s.text,N(s.children,r),s.key);n!=null&&e.push(n)}return e},M={[i.listItem]:"listItem",[i.oListItem]:"oListItem",[i.list]:"list",[i.oList]:"oList"},w=t=>(r,e,a,s,n)=>{const l=t[M[r]||r];if(l)return l({type:r,node:e,text:a,children:s,key:n})},H=(...t)=>(...r)=>{for(let e=0;e<t.length;e++){const a=t[e];if(a){const s=a(...r);if(s!=null)return s}}};var W=/["'&<>]/,f=A;function A(t){var r=""+t,e=W.exec(r);if(!e)return r;var a,s="",n=0,l=0;for(n=e.index;n<r.length;n++){switch(r.charCodeAt(n)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#39;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}l!==n&&(s+=r.substring(l,n)),l=n+1,s+=a}return l!==n?s+r.substring(l,n):s}const C=t=>{var r,e,a;return{link_type:c.Document,id:t.id,uid:(r=t.uid)!=null?r:void 0,type:t.type,tags:t.tags,lang:t.lang,url:(e=t.url)!=null?e:void 0,slug:(a=t.slugs)==null?void 0:a[0],...t.data&&Object.keys(t.data).length>0?{data:t.data}:{}}},E=(t,r)=>{if(!t)return null;const e="link_type"in t?t:C(t);switch(e.link_type){case c.Media:case c.Web:return"url"in e?e.url:null;case c.Document:{if("id"in e&&r){const a=r(e);if(a!=null)return a}return"url"in e&&e.url?e.url:null}case c.Any:default:return null}},o=t=>"data"in t&&"label"in t.data?` class="${t.data.label}"`:"",u=(t,r,e)=>`<${t}${o(r)}>${e.join("")}</${t}>`,R=t=>`<pre${o(t)}>${f(t.text)}</pre>`,q=(t,r)=>{let e=`<img src="${r.url}" alt="${f(r.alt)}"${r.copyright?` copyright="${f(r.copyright)}"`:""} />`;return r.linkTo&&(e=z(t,{type:i.hyperlink,data:r.linkTo,start:0,end:0},[e])),`<p class="block-img">${e}</p>`},P=t=>`<div data-oembed="${t.oembed.embed_url}" data-oembed-type="${t.oembed.type}" data-oembed-provider="${t.oembed.provider_name}"${o(t)}>${t.oembed.html}</div>`,z=(t,r,e)=>{switch(r.data.link_type){case c.Web:return`<a href="${f(r.data.url)}" ${r.data.target?`target="${r.data.target}" `:""}rel="noopener noreferrer"${o(r)}>${e.join("")}</a>`;case c.Document:return`<a href="${E(r.data,t)}"${o(r)}>${e.join("")}</a>`;case c.Media:return`<a href="${r.data.url}"${o(r)}>${e.join("")}</a>`}},U=t=>t?f(t).replace(/\n/g,"<br />"):"",k=t=>(r,e,a,s,n)=>{switch(e.type){case i.heading1:return u("h1",e,s);case i.heading2:return u("h2",e,s);case i.heading3:return u("h3",e,s);case i.heading4:return u("h4",e,s);case i.heading5:return u("h5",e,s);case i.heading6:return u("h6",e,s);case i.paragraph:return u("p",e,s);case i.preformatted:return R(e);case i.strong:return u("strong",e,s);case i.em:return u("em",e,s);case i.listItem:return u("li",e,s);case i.oListItem:return u("li",e,s);case i.list:return u("ul",e,s);case i.oList:return u("ol",e,s);case i.image:return q(t,e);case i.embed:return P(e);case i.hyperlink:return z(t,e,s);case i.label:return u("span",e,s);case i.span:default:return U(a)}},B=t=>{const r={};for(const e in t){const a=t[e];a&&(r[e]=s=>a({...s,children:s.children.join("")}))}return w(r)},G=(t,r,e)=>{if(t){let a;return e?a=H(typeof e=="object"?B(e):(s,n,l,p,g)=>e(s,n,l,p.join(""),g),k(r)):a=k(r),j(t,a).join("")}else return null};export{E as a,G as b};
